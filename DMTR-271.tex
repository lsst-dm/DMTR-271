% generated from JIRA project LVV
% using template at /usr/local/anaconda3/lib/python3.7/site-packages/docsteady/templates/tpr.latex.jinja2.
% using docsteady version 2.1.4.post21+gb03ef5c.d20210505
% Please do not edit -- update information in Jira instead
\documentclass[dm,lsstdraft,STR,toc]{lsstdoc}
\usepackage{geometry}
\usepackage{longtable,booktabs}
\usepackage{enumitem}
\usepackage{arydshln}
\usepackage{attachfile}
\usepackage{array}
\usepackage{dashrule}

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}

\input meta.tex

\newcommand{\attachmentsUrl}{https://github.com/\gitorg/\lsstDocType-\lsstDocNum/blob/\gitref/attachments}
\providecommand{\tightlist}{
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\setcounter{tocdepth}{4}

\begin{document}

\def\milestoneName{Gen 3 Butler Acceptance Testing}
\def\milestoneId{LDM-GEN3}
\def\product{Software Products}

\setDocCompact{true}

\title{LDM-GEN3: Gen 3 Butler Acceptance Testing Test Plan and Report}
\setDocRef{\lsstDocType-\lsstDocNum}
\date{ 2021-05-12 }
\author{ Robert Gruendl }

\input{history_and_info.tex}


\setDocAbstract{
This is the test plan and report for
\textbf{ Gen 3 Butler Acceptance Testing} (LDM-GEN3),
an LSST milestone pertaining to the Data Management Subsystem.\\
This document is based on content automatically extracted from the Jira test database on \docDate.
The most recent change to the document repository was on \vcsDate.
}


\maketitle

\section{Introduction}
\label{sect:intro}


\subsection{Objectives}
\label{sect:objectives}

 The goal of this test is to demonstrate that the Gen3 Butler software
project has sufficiently matured that subsequent DM development should
begin focusing on adoption of Gen3 Butler software are repositories
throughout the DM software project (i.e. that deprecation of Gen2 Butler
usage within the project can begin).



\subsection{System Overview}
\label{sect:systemoverview}

 The Gen3 refactoring of the Butler is central to evolution of the
overall DM software design and has repercussions throughout the rest of
the DM project. ~ This test plan is designed to verify that minimal
requirements have been met and the DM project can now begin the process
of integrating the Gen3 Butler within the pipelines and analysis tools.
~ Those minimal requirements are that:

\begin{enumerate}
\tightlist
\item
  possible to ingest all raw dataset types currently hosted at NCSA (for
  supported instruments)
\item
  cp\_pipe equivalent under Gen3 is available
\item
  developers can run a pipeline with a single-node using pipetask
\item
  an RC2-like processing is possible
\item
  a 3-tract RC2 test run can be performed in a reasonable time (under a
  week)
\item
  Calibration Product Pipelines (CPP) can be run at scales to support
  above investigations
\item
  Batch Processing System (BPS) is available to support testing at
  larger scales
\end{enumerate}

In addition, at the time these tests occur the Gen3 Butler schema be
considered stable enough that changes no longer occur on a weekly basis
(i.e force re-ingestion/migration of existing repositories are no longer
a weekly occurrence). Changes requiring wholesale reingestion/migration
may still be required but will occur in a regimented manner.\\
~\\
\textbf{Applicable Documents:}\\
\citeds{LDM-592}: Data Access Use Cases\\
\citeds{LDM-556}: Data Management Middleware Requirements\\
\citeds{LDM-639}: Data Management Acceptance Test Specification\\
~\\


\subsection{Document Overview}
\label{sect:docoverview}

This document was generated from Jira, obtaining the relevant information from the
\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testPlan/LVV-P77}{LVV-P77}
~Jira Test Plan and related Test Cycles (
\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C160}{LVV-C160}
\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C162}{LVV-C162}
).

Section \ref{sect:intro} provides an overview of the test campaign, the system under test (\product{}),
the applicable documentation, and explains how this document is organized.
Section \ref{sect:testplan} provides additional information about the test plan, like for example the configuration
used for this test or related documentation.
Section \ref{sect:personnel} describes the necessary roles and lists the individuals assigned to them.

Section \ref{sect:overview} provides a summary of the test results, including an overview in Table \ref{table:summary},
an overall assessment statement and suggestions for possible improvements.
Section \ref{sect:detailedtestresults} provides detailed results for each step in each test case.

The current status of test plan \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testPlan/LVV-P77}{LVV-P77} in Jira is \textbf{ Draft }.

\subsection{References}
\label{sect:references}
\renewcommand{\refname}{}
\bibliography{lsst,refs,books,refs_ads,local}


\newpage
\section{Test Plan Details}
\label{sect:testplan}


\subsection{Data Collection}

  Observing is not required for this test campaign.

\subsection{Verification Environment}
\label{sect:hwconf}
  These tests assume a stable weekly stack which supports Gen3 running of
the above, that services that automatically ingest new data can support
on-going ingestion to Gen3 repositories (i.e. DBB shared spaces and OODS
support serving data through Gen3), and that batch processing services
can support pipeline execution of Gen3 products.




\subsection{Related Documentation}


No additional documentation provided.


\subsection{PMCS Activity}

Primavera milestones related to the test campaign:
\begin{itemize}
\item LDM-GEN3
\end{itemize}


\newpage
\section{Personnel}
\label{sect:personnel}

The personnel involved in the test campaign is shown in the following table.

{\small
\begin{longtable}{p{3cm}p{3cm}p{3cm}p{6cm}}
\hline
\multicolumn{2}{r}{T. Plan \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testPlan/LVV-P77}{LVV-P77} owner:} &
\multicolumn{2}{l}{\textbf{ Robert Gruendl } }\\\hline
\multicolumn{2}{r}{T. Cycle \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C160}{LVV-C160} owner:} &
\multicolumn{2}{l}{\textbf{
Robert Gruendl }
} \\\hline
\textbf{Test Cases} & \textbf{Assigned to} & \textbf{Executed by} & \textbf{Additional Test Personnel} \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1985}{LVV-T1985}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1984}{LVV-T1984}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1982}{LVV-T1982}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1987}{LVV-T1987}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1986}{LVV-T1986}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1983}{LVV-T1983}
& {\small Leanne Guy } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\multicolumn{2}{r}{T. Cycle \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C162}{LVV-C162} owner:} &
\multicolumn{2}{l}{\textbf{
Undefined }
} \\\hline
\textbf{Test Cases} & \textbf{Assigned to} & \textbf{Executed by} & \textbf{Additional Test Personnel} \\ \hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T2007}{LVV-T2007}
& {\small Gabriele Comoretto [X] } & {\small  } &
\begin{minipage}[]{6cm}
\smallskip
{\small  }
\medskip
\end{minipage}
\\ \hline
\end{longtable}
}

\newpage

\section{Test Campaign Overview}
\label{sect:overview}

\subsection{Summary}
\label{sect:summarytable}

{\small
\begin{longtable}{p{2cm}cp{2.3cm}p{8.6cm}p{2.3cm}}
\toprule
\multicolumn{2}{r}{ T. Plan \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testPlan/LVV-P77}{LVV-P77}:} &
\multicolumn{2}{p{10.9cm}}{\textbf{ LDM-GEN3: Gen 3 Butler Acceptance Testing }} & Draft \\\hline
\multicolumn{2}{r}{ T. Cycle \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C160}{LVV-C160}:} &
\multicolumn{2}{p{10.9cm}}{\textbf{ LDM-503-GEN3-01: Gen 3 Butler Acceptance Testing }} & Not Executed \\\hline
\textbf{Test Cases} &  \textbf{Ver.} & \textbf{Status} & \textbf{Comment} & \textbf{Issues} \\\toprule
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1985}{LVV-T1985}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1984}{LVV-T1984}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1982}{LVV-T1982}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1987}{LVV-T1987}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1986}{LVV-T1986}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1983}{LVV-T1983}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\multicolumn{2}{r}{ T. Cycle \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCycle/LVV-C162}{LVV-C162}:} &
\multicolumn{2}{p{10.9cm}}{\textbf{ LDM-503-GEN3-01: Gen 3 Ingest ComCam raw dataset }} & Not Executed \\\hline
\textbf{Test Cases} &  \textbf{Ver.} & \textbf{Status} & \textbf{Comment} & \textbf{Issues} \\\toprule
\href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T2007}{LVV-T2007}
&  1
& Not Executed &
\begin{minipage}[]{9cm}
\smallskip

\medskip
\end{minipage}
&   \\\hline
\caption{Test Campaign Summary}
\label{table:summary}
\end{longtable}
}

\subsection{Overall Assessment}
\label{sect:overallassessment}

Not yet available.

\subsection{Recommended Improvements}
\label{sect:recommendations}

Not yet available.

\newpage
\section{Detailed Test Results}
\label{sect:detailedtestresults}

\subsection{Test Cycle LVV-C160 }

Open test cycle {\it \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testrun/LVV-C160}{LDM-503-GEN3-01: Gen 3 Butler Acceptance Testing}} in Jira.

Test Cycle name: LDM-503-GEN3-01: Gen 3 Butler Acceptance Testing\\
Status: Not Executed

Tests that Gen3 software maturity now supports development across the DM
project.\\
~\\
{[}GCM{]}\\
I see here 2 main groups of test:\\
i- ingestion of different raw dataset:\\
\hspace*{0.333em} ~ ~ ~ in case we have one single test case for
ingestion of data in Gen3 (T1985), we need to have one test cycle for
each type of raw data ingested\\
ii- various pipeline processing\\
\hspace*{0.333em} ~ ~ ~all these test cases can be part of a single test
cycle. In case T1985 is divided in many test cases, one per dataset,
those tests can also be included here.\\
\hspace*{0.333em} ~ ~ ~These test cases seem to be generic Science
Pipelines test cases, ae we sure they have not already been defined and
executed?

\subsubsection{Software Version/Baseline}
Not provided.

\subsubsection{Configuration}
Gen3 Butler repositories with test data are available within DBB spaces.
~Weekly DM stack has Gen3 and BPS elements present for tests.

\subsubsection{Test Cases in LVV-C160 Test Cycle}

\paragraph{ LVV-T1985 - Verify daf\_butler raw data ingest }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1985}{\textit{ LVV-T1985 } }
test case in Jira.

Demonstrate that a raw data type can be successfully ingested into a
Butler repository.\\
~\\
There should be the following steps:\\
- verify that the Gen3 repository is available\\
- ingest the raw data defined in the test cycle (to be divided in
multiple steps in case it makes sense)\\
- verify that the raw data is available in the repository as expected\\
In the case that the second step is different, depending on the raw
dataset, at this point it is necessary to have a different test case for
each of them, and multiple test cycles are not needed.\\
~\\
To note that, the original name "Ingest all the raw datasets that are
currently hosted at NCSA..." looks more to be a milestone, than a test
case definition.

\textbf{ Preconditions}:\\
In order to run this test, a Gen3 daf butler should be deployed and
ready to use, with access to the filesystems where the raw data to
ingest is stored.

Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}

\paragraph{ LVV-T1984 - Provide a recipe and example for a cp\_pipe equivalent }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1984}{\textit{ LVV-T1984 } }
test case in Jira.



\textbf{ Preconditions}:\\


Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}

\paragraph{ LVV-T1982 - Run a pipeline on a single node using pipetask. }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1982}{\textit{ LVV-T1982 } }
test case in Jira.

To show that individual users have the ability to run either locally (w/
sqlite) or generally (w/ Postgres) using Gen3 Butler infrastructure.

\textbf{ Preconditions}:\\
This test requires that Gen3 Butler infrastructure and underlying pipets
have been integrated. ~It further requires (in spirit) that gen3 schema
stability has been reached to facilitate comparison of pipeline results
with further stack development can be compared.

Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}

\paragraph{ LVV-T1987 - Run Calibration Products Processing (CPP) }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1987}{\textit{ LVV-T1987 } }
test case in Jira.

Tests should be run at scales corresponding to appropriate ~scales (e.g
DC2, RC2)

\textbf{ Preconditions}:\\


Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}

\paragraph{ LVV-T1986 - Run DC2-like processing (not necessarily full-scale) }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1986}{\textit{ LVV-T1986 } }
test case in Jira.



\textbf{ Preconditions}:\\


Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}

\paragraph{ LVV-T1983 - Run a 3 tract dataset (RC2) in under a week on NCSA Condor system using
BPS }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T1983}{\textit{ LVV-T1983 } }
test case in Jira.



\textbf{ Preconditions}:\\


Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}


\subsection{Test Cycle LVV-C162 }

Open test cycle {\it \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testrun/LVV-C162}{LDM-503-GEN3-01: Gen 3 Ingest ComCam raw dataset}} in Jira.

Test Cycle name: LDM-503-GEN3-01: Gen 3 Ingest ComCam raw dataset\\
Status: Not Executed

In the context of the milestone LDM-503-GEN3-01, Gen 3 Butler readiness,
this test cycle is defining the configuration and the dataset for
running a generic \textbf{Raw Data Ingestion Into Gen3 Butler} test
case, using specifically ComCam raw data.

\subsubsection{Software Version/Baseline}
Not provided.

\subsubsection{Configuration}
Not provided.

\subsubsection{Test Cases in LVV-C162 Test Cycle}

\paragraph{ LVV-T2007 - Raw Data Ingestion Into Gen3 Butler }\mbox{}\\

Version \textbf{1}.
Open  \href{https://jira.lsstcorp.org/secure/Tests.jspa#/testCase/LVV-T2007}{\textit{ LVV-T2007 } }
test case in Jira.

With this test case we prove that the ingestion of raw data is Gen3
Butler is working as expected.\\
~\\
We are not specifying any raw dataset type or version, nor we are
reffing to a specific version of Gen3 Butler software.\\
~\\
The raw dataset type and version shall be specified in the Test Cycle
where this test case is included. It is assumed that the ingestion
procedure in a Gen3 repository do not depend from the raw dataset
type.\\
~\\
The Gen3 Butler version shall be specified in the Test Plan, which
defines the test campaign and corresponds to the test milestone to be
fulfilled.

\textbf{ Preconditions}:\\
A Gen3 Butler instance has been created and is ready to use with
sufficient resources

Execution status: {\bf Not Executed }

Final comment:\\


Detailed steps results:

\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 1 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize
Verify that the repository where to ingest the data is available (create
it if it is not)

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}
\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 2 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize
Ingest the raw dataset following the instruction in the example code

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}
\begin{tabular}{p{2cm}p{14cm}}
\toprule
Step 3 & Step Execution Status: \textbf{ Not Executed } \\ \hline
\end{tabular}
 Description \\
{\footnotesize
Check that the raw dataset is available in the Gen3 repository

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Expected Result \\
{\footnotesize

}
\hdashrule[0.5ex]{\textwidth}{1pt}{3mm}
  Actual Result \\
{\footnotesize

}



\input{appendix.tex}
\end{document}
